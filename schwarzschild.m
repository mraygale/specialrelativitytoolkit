function result = schwarzschild(data, xs, rs, alt=false)  if rs == 0 || isempty(data)      result = data;  else    x = data(:,1);    t = data(:,2);    r = sign(xs) * (xs - x);    outside = find(r > rs);    if isempty(outside)      result = [];    else      x = x(outside);      t = t(outside) ./ lightspeed(r(outside), rs, alt);      result = cat(2, x, t);    endif  endifendfunctionfunction result = lightspeed(r, rs, alt=false)  if alt    result = sqrt(1 - (rs ./ r).^2);  else    result = 1 - rs ./ r;  endifendfunction